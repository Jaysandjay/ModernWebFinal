<%- include('partials/header', { title: 'Update Movie' }) %>

<h1>Update Movie Information</h1>
<div class="form-container">
    <% if (typeof movieToEdit !== 'undefined') { %>
        <form action="/update/<%= movieToEdit.id %>" method="post" >

        <div>
            <label for="name">Name:</label>
            <input type="text" id="name" name="name" value="<%= movieToEdit.name %>">
        </div>

        <div>
            <label for="description">Description:</label>
            <input type="text" id="description" name="description" value="<%= movieToEdit.description %>">
        </div>

        <div>
            <label for="year">Year:</label>
            <input type="number" id="year" name="year" value="<%= movieToEdit.year %>" required>
            <small id="year-help" class="help-text" style="color: #666"></small>
        </div>

        <div>
            <label for="genre">Genre:</label>
            <input type="text" id="genre" name="genre" value="<%= movieToEdit.genre %>">
        </div>

        <div>
            <label for="rating">Rating:</label>
            <input type="number" id="rating" name="rating" value="<%= movieToEdit.rating %>">
        </div>
        <div>
            <label for="rating">Music:</label>
            <input type="text" id="music" name="music"  value="<%= movieToEdit.music %>">
        </div>

        <button type="submit" class="submit-btn">Submit</button>
    </form>
</div>
    <% } else { %>
        <p style="color: red;">No Movie information available to edit</p>
    <% } %>
>
    <% if (typeof error !== 'undefined') { %>
        <p style="color: red"> <%= error %> </p>
    <% } %>

    <% if (typeof message !== 'undefined') { %>
        <p style="color: green"> <%= message %> </p>
    <% } %>
</div>

<script>
  (function() {
    const earliest = 1895;
    const current = new Date().getFullYear();
    const yearInput = document.getElementById('year');
    const help = document.getElementById('year-help');
    if (!yearInput) return;
    yearInput.min = earliest;
    yearInput.max = current;
    help.textContent = `Enter a year between ${earliest} and ${current}.`;
    yearInput.addEventListener('input', () => {
      const v = parseInt(yearInput.value, 10);
      if (!yearInput.value) {
        help.textContent = `Enter a year between ${earliest} and ${current}.`;
      } else if (isNaN(v) || v < earliest || v > current) {
        help.textContent = `Year must be between ${earliest} and ${current}.`;
      } else {
        help.textContent = '';
      }
    });
  })();
</script>

<%- include('partials/footer') %>
